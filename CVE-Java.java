import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.Signature;

public class Test {
  public static void main(String[] args) throws Exception {
    KeyPair keys = KeyPairGenerator.getInstance("EC").generateKeyPair();
    byte[] blankSignature = new byte[64];
    try {
      Signature sig = Signature.getInstance("SHA256WithECDSAInP1363Format");
      sig.initVerify(keys.getPublic());
      sig.update("Hello, World".getBytes());
      if (sig.verify(blankSignature)) {
        System.out.println("Found CVE-2022-21449 vulnerability!!!");
      } else {
        System.out.println("OK!");
      }
    } catch (Exception ex) {
      System.out.println("ECDSA is not support. OK!");
    }
  }
}
